# WordPress Exclusions - Before CRS
# Estas reglas se ejecutan ANTES de las reglas CRS

# Permitir métodos necesarios para WordPress
SecAction "id:900200,phase:1,pass,t:none,nolog,setvar:tx.allowed_methods=GET HEAD POST OPTIONS PUT PATCH DELETE"

# Aumentar límites para el editor de WordPress (Gutenberg)
SecAction "id:900300,phase:1,pass,t:none,nolog,setvar:tx.max_num_args=512"
SecAction "id:900310,phase:1,pass,t:none,nolog,setvar:tx.arg_length=8000"
SecAction "id:900320,phase:1,pass,t:none,nolog,setvar:tx.total_arg_length=64000"

# Excluir wp-admin de algunas reglas estrictas
SecRule REQUEST_URI "@beginsWith /wp-admin/" "id:1000,phase:1,pass,t:none,nolog,ctl:ruleRemoveById=920170"
SecRule REQUEST_URI "@beginsWith /wp-admin/" "id:1001,phase:1,pass,t:none,nolog,ctl:ruleRemoveById=921180"
SecRule REQUEST_URI "@beginsWith /wp-admin/" "id:1002,phase:1,pass,t:none,nolog,ctl:ruleRemoveById=930120"

# Excluir wp-json API de reglas que causan falsos positivos
SecRule REQUEST_URI "@beginsWith /wp-json/" "id:1010,phase:1,pass,t:none,nolog,ctl:ruleRemoveById=920170"
SecRule REQUEST_URI "@beginsWith /wp-json/" "id:1011,phase:1,pass,t:none,nolog,ctl:ruleRemoveById=921110"
SecRule REQUEST_URI "@beginsWith /wp-json/" "id:1012,phase:1,pass,t:none,nolog,ctl:ruleRemoveById=942100"
SecRule REQUEST_URI "@beginsWith /wp-json/" "id:1013,phase:1,pass,t:none,nolog,ctl:ruleRemoveById=942200"
SecRule REQUEST_URI "@beginsWith /wp-json/" "id:1014,phase:1,pass,t:none,nolog,ctl:ruleRemoveById=942260"
SecRule REQUEST_URI "@beginsWith /wp-json/" "id:1015,phase:1,pass,t:none,nolog,ctl:ruleRemoveById=949110"

# Excluir upload de archivos
SecRule REQUEST_URI "@endsWith /async-upload.php" "id:1020,phase:1,pass,t:none,nolog,ctl:ruleRemoveById=200003"

# Excluir post.php y admin-ajax.php de reglas de cuerpo
SecRule REQUEST_URI "@endsWith /post.php" "id:1030,phase:1,pass,t:none,nolog,ctl:ruleRemoveById=942100"
SecRule REQUEST_URI "@endsWith /post.php" "id:1031,phase:1,pass,t:none,nolog,ctl:ruleRemoveById=942200"
SecRule REQUEST_URI "@endsWith /post.php" "id:1032,phase:1,pass,t:none,nolog,ctl:ruleRemoveById=942260"
SecRule REQUEST_URI "@endsWith /post.php" "id:1033,phase:1,pass,t:none,nolog,ctl:ruleRemoveById=941100"
SecRule REQUEST_URI "@endsWith /post.php" "id:1034,phase:1,pass,t:none,nolog,ctl:ruleRemoveById=941160"

SecRule REQUEST_URI "@endsWith /admin-ajax.php" "id:1040,phase:1,pass,t:none,nolog,ctl:ruleRemoveById=942100"
SecRule REQUEST_URI "@endsWith /admin-ajax.php" "id:1041,phase:1,pass,t:none,nolog,ctl:ruleRemoveById=942200"
SecRule REQUEST_URI "@endsWith /admin-ajax.php" "id:1042,phase:1,pass,t:none,nolog,ctl:ruleRemoveById=942260"
SecRule REQUEST_URI "@endsWith /admin-ajax.php" "id:1043,phase:1,pass,t:none,nolog,ctl:ruleRemoveById=941100"
